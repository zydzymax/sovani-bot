#!/usr/bin/env python3
"""
–§–ò–ù–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ò–°–¢–ò–ù–´
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö WB –∫–∞–±–∏–Ω–µ—Ç–∞ —Å API –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π
"""

import logging
from datetime import datetime

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(name)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

class FinalTruthAnalyzer:
    """–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∏—Å—Ç–∏–Ω–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π"""

    def __init__(self):
        pass

    def analyze_wb_cabinet_data(self):
        """–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞ WB –∑–∞ —è–Ω–≤–∞—Ä—å 2025"""

        logger.info("üéØ –ê–ù–ê–õ–ò–ó –î–ê–ù–ù–´–• –ò–ó –ö–ê–ë–ò–ù–ï–¢–ê WB –ó–ê –Ø–ù–í–ê–†–¨ 2025")
        logger.info("=" * 60)

        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞ (–∏–∑ –≤–∞—à–µ–≥–æ –æ—Ç—á–µ—Ç–∞)
        cabinet_data = {
            # –ó–∞–∫–∞–∑–∞–Ω–æ
            'total_orders_count': 0,
            'total_orders_amount': 0,

            # –í—ã–∫—É–ø–ª–µ–Ω–æ
            'total_buyouts_count': 0,
            'total_buyouts_amount': 0,

            # –û—Å—Ç–∞—Ç–∫–∏
            'total_remains': 0
        }

        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫–∏ –∏–∑ –æ—Ç—á–µ—Ç–∞ (–ø—Ä–∏–º–µ—Ä—ã)
        sample_lines = [
            # –ö–æ—Å—Ç—é–º—ã
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 1, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 2278.21, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 0, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 0, '–æ—Å—Ç–∞—Ç–æ–∫': 0},
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 1, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 2071.1, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 1, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 2071.1, '–æ—Å—Ç–∞—Ç–æ–∫': 0},
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 1, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 2071.1, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 1, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 2071.1, '–æ—Å—Ç–∞—Ç–æ–∫': 0},

            # –ü–∏–∂–∞–º—ã PM-LETO/–≥—Ä–∞—Ñ–∏—Ç
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 1, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 789.18, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 1, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 789.18, '–æ—Å—Ç–∞—Ç–æ–∫': 0},
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 1, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 742.76, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 1, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 742.76, '–æ—Å—Ç–∞—Ç–æ–∫': 17},
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 3, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 3945.91, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 1, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 1624.78, '–æ—Å—Ç–∞—Ç–æ–∫': 0},
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 3, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 3156.73, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 2, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 1531.94, '–æ—Å—Ç–∞—Ç–æ–∫': 30},

            # –ü–∏–∂–∞–º—ã PM-TOP/oliva
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 2, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 1903.32, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 2, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 1903.31, '–æ—Å—Ç–∞—Ç–æ–∫': 1},
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 1, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 835.6, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 1, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 835.6, '–æ—Å—Ç–∞—Ç–æ–∫': 1},
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 2, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 2460.39, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 1, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 835.6, '–æ—Å—Ç–∞—Ç–æ–∫': 22},
            {'–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç': 4, '–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞': 3574.52, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç': 3, '–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞': 2738.91, '–æ—Å—Ç–∞—Ç–æ–∫': 31},

            # –ò —Ç–∞–∫ –¥–∞–ª–µ–µ...
        ]

        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä–Ω—ã–µ –∏—Ç–æ–≥–∏ (–∏–∑ –≤–∏–¥–∏–º–æ–π —á–∞—Å—Ç–∏ –æ—Ç—á–µ—Ç–∞)
        for line in sample_lines:
            cabinet_data['total_orders_count'] += line['–∑–∞–∫–∞–∑–∞–Ω–æ_—à—Ç']
            cabinet_data['total_orders_amount'] += line['–∑–∞–∫–∞–∑–∞–Ω–æ_—Å—É–º–º–∞']
            cabinet_data['total_buyouts_count'] += line['–≤—ã–∫—É–ø–ª–µ–Ω–æ_—à—Ç']
            cabinet_data['total_buyouts_amount'] += line['–≤—ã–∫—É–ø–ª–µ–Ω–æ_—Å—É–º–º–∞']
            cabinet_data['total_remains'] += line['–æ—Å—Ç–∞—Ç–æ–∫']

        logger.info(f"üìä –ü–†–ò–ú–ï–†–ù–´–ï –î–ê–ù–ù–´–ï –ò–ó –ö–ê–ë–ò–ù–ï–¢–ê (–≤–∏–¥–∏–º–∞—è —á–∞—Å—Ç—å):")
        logger.info(f"   üõí –ó–∞–∫–∞–∑–∞–Ω–æ: {cabinet_data['total_orders_count']} —à—Ç –Ω–∞ {cabinet_data['total_orders_amount']:,.2f} ‚ÇΩ")
        logger.info(f"   ‚úÖ –í—ã–∫—É–ø–ª–µ–Ω–æ: {cabinet_data['total_buyouts_count']} —à—Ç –Ω–∞ {cabinet_data['total_buyouts_amount']:,.2f} ‚ÇΩ")
        logger.info(f"   üì¶ –û—Å—Ç–∞—Ç–∫–æ–≤: {cabinet_data['total_remains']} —à—Ç")

        return cabinet_data

    def compare_with_api_data(self, cabinet_data):
        """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏ API"""

        logger.info("\nüîç –°–†–ê–í–ù–ï–ù–ò–ï –ö–ê–ë–ò–ù–ï–¢–ê WB –° API –î–ê–ù–ù–´–ú–ò")
        logger.info("=" * 50)

        # –î–∞–Ω–Ω—ã–µ API (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç–µ—Å—Ç–æ–≤)
        api_data = {
            'sales_count': 360,
            'sales_priceWithDisc': 602796,
            'sales_forPay': 425436,
            'orders_count': 607,
            'orders_priceWithDisc': 1022424,
        }

        logger.info(f"üì± –ö–ê–ë–ò–ù–ï–¢ WB:")
        logger.info(f"   –í—ã–∫—É–ø–ª–µ–Ω–æ: ~{cabinet_data['total_buyouts_count']} —à—Ç –Ω–∞ ~{cabinet_data['total_buyouts_amount']:,.0f} ‚ÇΩ")

        logger.info(f"\nüîå API SALES:")
        logger.info(f"   –ó–∞–ø–∏—Å–µ–π: {api_data['sales_count']}")
        logger.info(f"   priceWithDisc: {api_data['sales_priceWithDisc']:,.0f} ‚ÇΩ")
        logger.info(f"   forPay: {api_data['sales_forPay']:,.0f} ‚ÇΩ")

        logger.info(f"\nüîå API ORDERS:")
        logger.info(f"   –ó–∞–ø–∏—Å–µ–π: {api_data['orders_count']}")
        logger.info(f"   priceWithDisc: {api_data['orders_priceWithDisc']:,.0f} ‚ÇΩ")

        # –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π
        if cabinet_data['total_buyouts_amount'] > 0:
            api_vs_cabinet_ratio = api_data['sales_priceWithDisc'] / cabinet_data['total_buyouts_amount']
            logger.info(f"\nüéØ –°–û–û–¢–ù–û–®–ï–ù–ò–ï API/–ö–ê–ë–ò–ù–ï–¢: {api_vs_cabinet_ratio:.1f}x")

        return api_data

    def analyze_key_insights(self):
        """–ê–Ω–∞–ª–∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –∏–Ω—Å–∞–π—Ç–æ–≤"""

        logger.info("\nüí° –ö–õ–Æ–ß–ï–í–´–ï –ù–ê–•–û–î–ö–ò:")
        logger.info("=" * 40)

        logger.info("1Ô∏è‚É£ –†–ï–ê–õ–¨–ù–´–ï –¶–ï–ù–´ –í –ö–ê–ë–ò–ù–ï–¢–ï:")
        logger.info("   ‚Ä¢ –ö–æ—Å—Ç—é–º: ~2,071‚ÇΩ")
        logger.info("   ‚Ä¢ –ü–∏–∂–∞–º–∞ PM-LETO: ~742-789‚ÇΩ")
        logger.info("   ‚Ä¢ –ü–∏–∂–∞–º–∞ PM-TOP: ~835-1,903‚ÇΩ")
        logger.info("   ‚Ä¢ –ö—É–ø–∞–ª—å–Ω–∏–∫: ~714-773‚ÇΩ")

        logger.info("\n2Ô∏è‚É£ API –ü–û–ö–ê–ó–´–í–ê–ï–¢ –ü–û–•–û–ñ–ò–ï –¶–ï–ù–´:")
        logger.info("   ‚Ä¢ API priceWithDisc: 1,557‚ÇΩ (–ø–∏–∂–∞–º–∞)")
        logger.info("   ‚Ä¢ API forPay: 1,152‚ÇΩ")
        logger.info("   ‚Ä¢ –¶–µ–Ω—ã –†–ï–ê–õ–ò–°–¢–ò–ß–ù–´, –Ω–µ –≤ –∫–æ–ø–µ–π–∫–∞—Ö!")

        logger.info("\n3Ô∏è‚É£ –ü–†–û–ë–õ–ï–ú–ê –ù–ï –í –¶–ï–ù–ê–•:")
        logger.info("   ‚Ä¢ –¶–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ")
        logger.info("   ‚Ä¢ –ü—Ä–æ–±–ª–µ–º–∞ –≤ –ö–û–õ–ò–ß–ï–°–¢–í–ï –∏–ª–∏ –ü–ï–†–ò–û–î–ï")

        logger.info("\n4Ô∏è‚É£ –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´ –ó–ê–í–´–®–ï–ù–ò–Ø:")
        logger.info("   ‚Ä¢ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –í–ï–°–¨ –ì–û–î –≤–º–µ—Å—Ç–æ —è–Ω–≤–∞—Ä—è")
        logger.info("   ‚Ä¢ API –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –í–°–ï –°–ö–õ–ê–î–´ –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥")
        logger.info("   ‚Ä¢ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º –≤ API")

    def suggest_real_solution(self):
        """–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è"""

        logger.info("\nüîß –†–ï–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï:")
        logger.info("=" * 40)

        logger.info("1Ô∏è‚É£ –ü–†–û–í–ï–†–ò–¢–¨ –§–ò–õ–¨–¢–†–ê–¶–ò–Æ –î–ê–¢ –í API:")
        logger.info("   ‚Ä¢ –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¢–û–õ–¨–ö–û —è–Ω–≤–∞—Ä—å")
        logger.info("   ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç –≤ –∑–∞–ø—Ä–æ—Å–µ")
        logger.info("   ‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –ø–æ–ª—é 'date'")

        logger.info("\n2Ô∏è‚É£ –ü–†–û–í–ï–†–ò–¢–¨ –ê–ì–†–ï–ì–ê–¶–ò–Æ:")
        logger.info("   ‚Ä¢ –ú–æ–∂–µ—Ç –±—ã—Ç—å API —Å—É–º–º–∏—Ä—É–µ—Ç –ø–æ –≤—Å–µ–º –ø–µ—Ä–∏–æ–¥–∞–º")
        logger.info("   ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ—Ç –ª–∏ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Ç–æ–≥–æ–≤")

        logger.info("\n3Ô∏è‚É£ –°–†–ê–í–ù–ò–¢–¨ –ö–û–ù–ö–†–ï–¢–ù–´–ï –¢–û–í–ê–†–´:")
        logger.info("   ‚Ä¢ –ù–∞–π—Ç–∏ –ø–∏–∂–∞–º—É PM-TOP/oliva –≤ API")
        logger.info("   ‚Ä¢ –°—Ä–∞–≤–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂ –ø–æ —ç—Ç–æ–º—É —Ç–æ–≤–∞—Ä—É")
        logger.info("   ‚Ä¢ –ö–∞–±–∏–Ω–µ—Ç: ~10 –ø—Ä–æ–¥–∞–∂, API: —Å–∫–æ–ª—å–∫–æ?")

        logger.info("\n4Ô∏è‚É£ –ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ –ö–û–≠–§–§–ò–¶–ò–ï–ù–¢–´:")
        logger.info("   ‚Ä¢ –ù–∞–π—Ç–∏ –ö–û–†–ù–ï–í–£–Æ –ø—Ä–∏—á–∏–Ω—É")
        logger.info("   ‚Ä¢ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö")
        logger.info("   ‚Ä¢ –ü–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ 1:1")

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å—Ç–∏–Ω—ã"""

    analyzer = FinalTruthAnalyzer()

    logger.info("üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ò–°–¢–ò–ù–´")
    logger.info("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–±–∏–Ω–µ—Ç–∞ WB —Å API –¥–∞–Ω–Ω—ã–º–∏")

    # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç–∞
    cabinet_data = analyzer.analyze_wb_cabinet_data()

    # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å API
    api_data = analyzer.compare_with_api_data(cabinet_data)

    # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–Ω—Å–∞–π—Ç—ã
    analyzer.analyze_key_insights()

    # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ
    analyzer.suggest_real_solution()

    logger.info("\nüéâ –ò–°–¢–ò–ù–ê –ù–ê–ô–î–ï–ù–ê!")
    logger.info("–ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ —Ü–µ–Ω–∞—Ö, –∞ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–µ—Ä–∏–æ–¥–∞ –∏–ª–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö")

if __name__ == "__main__":
    main()